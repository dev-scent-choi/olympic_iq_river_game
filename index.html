<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olympic I.Q. ê°• ê±´ë„ˆê¸° - ì¡°ë ¨ì‚¬ì™€ 5ë§ˆë¦¬ ë™ë¬¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to bottom, #87CEEB 0%, #98D8E8 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            max-width: 1000px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .instructions {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
            line-height: 1.6;
        }

        .instructions strong {
            color: #d32f2f;
        }

        .instructions ul {
            margin: 10px 0 10px 20px;
        }

        .fight-diagram {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }

        .fight-diagram-title {
            font-weight: bold;
            color: #d32f2f;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .fight-circle {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin: 20px auto;
            width: 320px;
            height: 320px;
        }

        .fight-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .animal-node {
            position: absolute;
            width: 60px;
            height: 60px;
            background: white;
            border: 3px solid #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 35px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 1;
        }

        .animal-node.node-elephant {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        .animal-node.node-tiger {
            top: 80px;
            right: 40px;
        }

        .animal-node.node-dog {
            bottom: 80px;
            right: 40px;
        }

        .animal-node.node-cat {
            bottom: 80px;
            left: 40px;
        }

        .animal-node.node-mouse {
            top: 80px;
            left: 40px;
        }

        .game-board {
            position: relative;
            height: 450px;
            background: linear-gradient(to right,
                #8B7355 0%, #8B7355 25%,
                #4FC3F7 25%, #4FC3F7 75%,
                #8B7355 75%, #8B7355 100%);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: inset 0 4px 10px rgba(0,0,0,0.3);
        }

        .river-waves {
            position: absolute;
            left: 25%;
            width: 50%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                #4FC3F7 0px,
                #29B6F6 20px,
                #4FC3F7 40px
            );
            animation: wave 3s linear infinite;
            opacity: 0.5;
        }

        @keyframes wave {
            0% { background-position: 0 0; }
            100% { background-position: 0 40px; }
        }

        .shore {
            position: absolute;
            top: 0;
            height: 100%;
            width: 25%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 15px 10px;
            overflow-y: auto;
        }

        .left-shore {
            left: 0;
        }

        .right-shore {
            right: 0;
        }

        .animal {
            width: 65px;
            height: 65px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 35px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            background: white;
            border: 3px solid #333;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            margin: 8px auto;
            position: relative;
        }

        .animal:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .animal.selected {
            border-color: #4CAF50;
            border-width: 4px;
            transform: scale(1.15);
            box-shadow: 0 0 20px #4CAF50;
        }

        .animal .weight {
            position: absolute;
            bottom: -18px;
            font-size: 10px;
            color: #555;
            font-weight: bold;
            background: white;
            padding: 2px 4px;
            border-radius: 3px;
            border: 1px solid #ddd;
        }

        .boat {
            position: absolute;
            width: 200px;
            height: 120px;
            background: #8B4513;
            border-radius: 50%;
            border-top-left-radius: 80%;
            border-top-right-radius: 80%;
            top: 50%;
            transform: translateY(-50%);
            transition: left 2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 15px;
            z-index: 10;
        }

        .boat::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 10%;
            width: 80%;
            height: 15px;
            background: #654321;
            border-radius: 50%;
        }

        .boat-left {
            left: 20%;
        }

        .boat-right {
            left: 58%;
        }

        .boat-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .trainer {
            font-size: 40px;
        }

        .weight-display {
            background: rgba(255,255,255,0.9);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            font-weight: bold;
        }

        .weight-display.overweight {
            background: #ffcdd2;
            color: #c62828;
            animation: shake 0.5s;
        }

        .boat-animals {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 180px;
        }

        .boat-animals .animal {
            width: 50px;
            height: 50px;
            font-size: 28px;
            border-width: 2px;
            margin: 0;
        }

        .boat-animals .animal .weight {
            display: none;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .move-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .move-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .move-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .reset-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .status {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            padding: 15px;
            border-radius: 10px;
            background: #e3f2fd;
            color: #1976d2;
        }

        .status.warning {
            background: #ffebee;
            color: #c62828;
            animation: shake 0.5s;
        }

        .status.success {
            background: #e8f5e9;
            color: #2e7d32;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .fight-animation {
            animation: fight 1s ease-in-out;
        }

        @keyframes fight {
            0% { transform: scale(1) rotate(0deg); opacity: 1; }
            25% { transform: scale(1.3) rotate(-15deg); }
            50% { transform: scale(1.3) rotate(15deg); }
            75% { transform: scale(1.3) rotate(-15deg); }
            100% { transform: scale(1.5) rotate(0deg); opacity: 0.3; }
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            font-size: 16px;
            color: #555;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            background: #f5f5f5;
            padding: 10px 20px;
            border-radius: 8px;
            border: 2px solid #ddd;
        }

        .game-over-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s;
        }

        .game-over-modal.show {
            display: flex;
        }

        .game-over-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s;
        }

        .game-over-title {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .game-over-message {
            font-size: 24px;
            color: #d32f2f;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .game-over-detail {
            font-size: 18px;
            color: #555;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .game-over-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .game-over-buttons button {
            padding: 15px 40px;
            font-size: 18px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .retry-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .retry-btn:hover {
            transform: scale(1.05);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .win-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s;
        }

        .win-modal.show {
            display: flex;
        }

        .win-content {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s;
        }

        .win-title {
            font-size: 60px;
            margin-bottom: 20px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .win-message {
            font-size: 28px;
            color: #2e7d32;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .win-detail {
            font-size: 18px;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .game-board {
                height: 400px;
            }

            .animal {
                width: 55px;
                height: 55px;
                font-size: 30px;
            }

            .boat {
                width: 160px;
                height: 100px;
            }

            h1 {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ® Olympic I.Q. ê°• ê±´ë„ˆê¸°</h1>
        <div class="subtitle">ì¡°ë ¨ì‚¬ì™€ 5ë§ˆë¦¬ ë™ë¬¼ì˜ ëª¨í—˜</div>

        <div class="instructions">
            <strong>ğŸ¯ ê²Œì„ ëª©í‘œ:</strong> ì¡°ë ¨ì‚¬ê°€ ëª¨ë“  ë™ë¬¼ì„ ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ ê°•ë‘‘ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì´ë™ì‹œí‚¤ì„¸ìš”!<br><br>

            <strong>ğŸ“‹ ê·œì¹™:</strong>
            <ul>
                <li>ë°°ì˜ ìµœëŒ€ í—ˆìš© ì¤‘ëŸ‰: <strong>5000</strong> (ì¡°ë ¨ì‚¬ ì œì™¸)</li>
                <li>ë™ë¬¼ ì¤‘ëŸ‰: ğŸ˜ì½”ë¼ë¦¬(4800), ğŸ¯í˜¸ë‘ì´(3700), ğŸ•ê°œ(1200), ğŸ±ê³ ì–‘ì´(600), ğŸ­ì¥(200)</li>
                <li>ì¡°ë ¨ì‚¬ê°€ í•¨ê»˜ ìˆìœ¼ë©´ ëª¨ë“  ë™ë¬¼ì´ ì•ˆì „í•©ë‹ˆë‹¤!</li>
            </ul>

            <div class="fight-diagram">
                <div class="fight-diagram-title">âš ï¸ ì¡°ë ¨ì‚¬ê°€ ì—†ìœ¼ë©´ ì´ ì¡°í•©ë“¤ì´ ì‹¸ì›ë‹ˆë‹¤!</div>
                <div class="fight-circle">
                    <!-- SVGë¡œ ì •í™•í•œ ì„  ê·¸ë¦¬ê¸° -->
                    <svg class="fight-svg" viewBox="0 0 320 320">
                        <!-- ì½”ë¼ë¦¬(ì¤‘ì•™ ìƒë‹¨) - í˜¸ë‘ì´(ìš°ì¸¡ ìƒë‹¨) -->
                        <line x1="160" y1="40" x2="250" y2="110" stroke="#f44336" stroke-width="3" />
                        <!-- í˜¸ë‘ì´(ìš°ì¸¡ ìƒë‹¨) - ê°œ(ìš°ì¸¡ í•˜ë‹¨) -->
                        <line x1="250" y1="110" x2="250" y2="210" stroke="#f44336" stroke-width="3" />
                        <!-- ê°œ(ìš°ì¸¡ í•˜ë‹¨) - ê³ ì–‘ì´(ì¢Œì¸¡ í•˜ë‹¨) -->
                        <line x1="250" y1="210" x2="70" y2="210" stroke="#f44336" stroke-width="3" />
                        <!-- ê³ ì–‘ì´(ì¢Œì¸¡ í•˜ë‹¨) - ì¥(ì¢Œì¸¡ ìƒë‹¨) -->
                        <line x1="70" y1="210" x2="70" y2="110" stroke="#f44336" stroke-width="3" />
                        <!-- ì¥(ì¢Œì¸¡ ìƒë‹¨) - ì½”ë¼ë¦¬(ì¤‘ì•™ ìƒë‹¨) -->
                        <line x1="70" y1="110" x2="160" y2="40" stroke="#f44336" stroke-width="3" />
                    </svg>

                    <div class="animal-node node-elephant">ğŸ˜</div>
                    <div class="animal-node node-tiger">ğŸ¯</div>
                    <div class="animal-node node-dog">ğŸ•</div>
                    <div class="animal-node node-cat">ğŸ±</div>
                    <div class="animal-node node-mouse">ğŸ­</div>
                </div>
                <div style="font-size: 12px; color: #666;">ë¶‰ì€ ì„ ìœ¼ë¡œ ì—°ê²°ëœ ë™ë¬¼ë“¤ì€ ì¡°ë ¨ì‚¬ ì—†ì´ ë§Œë‚˜ë©´ ì‹¸ì›ë‹ˆë‹¤</div>
            </div>
        </div>

        <div class="game-board">
            <div class="river-waves"></div>

            <div class="shore left-shore" id="leftShore">
                <!-- ë™ë¬¼ë“¤ì´ ì—¬ê¸° ë°°ì¹˜ë©ë‹ˆë‹¤ -->
            </div>

            <div class="boat boat-left" id="boat">
                <div class="boat-header">
                    <div class="trainer">ğŸ‘¨</div>
                    <div class="weight-display" id="weightDisplay">0/5000</div>
                </div>
                <div class="boat-animals" id="boatAnimals">
                    <!-- ë°°ì— íƒ„ ë™ë¬¼ë“¤ -->
                </div>
            </div>

            <div class="shore right-shore" id="rightShore">
                <!-- ë„ì°©í•œ ë™ë¬¼ë“¤ì´ ì—¬ê¸° ë°°ì¹˜ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <div class="controls">
            <button class="move-btn" id="moveBtn" onclick="moveBoat()">â›µ ë°° ì´ë™í•˜ê¸°</button>
            <button class="reset-btn" onclick="resetGame()">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
        </div>

        <div class="status" id="status">ë™ë¬¼ì„ í´ë¦­í•˜ì—¬ ë°°ì— íƒœìš°ì„¸ìš”!</div>

        <div class="stats">
            <div class="stat-item">ì´ë™ íšŸìˆ˜: <span id="movesCounter">0</span></div>
            <div class="stat-item">ìµœì†Œ ì´ë™: <strong>7íšŒ</strong></div>
        </div>
    </div>

    <!-- ê²Œì„ ì˜¤ë²„ ëª¨ë‹¬ -->
    <div class="game-over-modal" id="gameOverModal">
        <div class="game-over-content">
            <div class="game-over-title">ğŸ’¥</div>
            <div class="game-over-message">ê²Œì„ ì˜¤ë²„!</div>
            <div class="game-over-detail" id="gameOverDetail"></div>
            <div class="game-over-buttons">
                <button class="retry-btn" onclick="closeGameOverModal()">ë‹¤ì‹œ ì‹œì‘</button>
            </div>
        </div>
    </div>

    <!-- ìŠ¹ë¦¬ ëª¨ë‹¬ -->
    <div class="win-modal" id="winModal">
        <div class="win-content">
            <div class="win-title">ğŸ‰</div>
            <div class="win-message">ì¶•í•˜í•©ë‹ˆë‹¤!</div>
            <div class="win-detail" id="winDetail"></div>
            <div class="game-over-buttons">
                <button class="retry-btn" onclick="closeWinModal()">ë‹¤ì‹œ ë„ì „</button>
            </div>
        </div>
    </div>

    <script>
        const animals = [
            { id: 'elephant', emoji: 'ğŸ˜', name: 'ì½”ë¼ë¦¬', weight: 4800 },
            { id: 'tiger', emoji: 'ğŸ¯', name: 'í˜¸ë‘ì´', weight: 3700 },
            { id: 'dog', emoji: 'ğŸ•', name: 'ê°œ', weight: 1200 },
            { id: 'cat', emoji: 'ğŸ±', name: 'ê³ ì–‘ì´', weight: 600 },
            { id: 'mouse', emoji: 'ğŸ­', name: 'ì¥', weight: 200 }
        ];

        // ì‹¸ìš°ëŠ” ì¡°í•©
        const fightPairs = [
            ['elephant', 'tiger'],
            ['tiger', 'dog'],
            ['dog', 'cat'],
            ['cat', 'mouse'],
            ['mouse', 'elephant']
        ];

        let gameState = {
            leftShore: ['elephant', 'tiger', 'dog', 'cat', 'mouse'],
            rightShore: [],
            boat: [],
            boatPosition: 'left',
            moves: 0,
            maxWeight: 5000
        };

        function initGame() {
            renderGame();
            updateStatus('ë™ë¬¼ì„ í´ë¦­í•˜ì—¬ ë°°ì— íƒœìš°ì„¸ìš”!');
        }

        function getAnimalWeight(animalIds) {
            return animalIds.reduce((sum, id) => {
                const animal = animals.find(a => a.id === id);
                return sum + (animal ? animal.weight : 0);
            }, 0);
        }

        function renderGame() {
            const leftShore = document.getElementById('leftShore');
            const rightShore = document.getElementById('rightShore');
            const boatAnimals = document.getElementById('boatAnimals');
            const weightDisplay = document.getElementById('weightDisplay');

            leftShore.innerHTML = '';
            rightShore.innerHTML = '';
            boatAnimals.innerHTML = '';

            // ì™¼ìª½ ê°•ë‘‘ ë™ë¬¼ë“¤
            gameState.leftShore.forEach(animalId => {
                const animal = animals.find(a => a.id === animalId);
                const div = createAnimalElement(animal);
                leftShore.appendChild(div);
            });

            // ì˜¤ë¥¸ìª½ ê°•ë‘‘ ë™ë¬¼ë“¤
            gameState.rightShore.forEach(animalId => {
                const animal = animals.find(a => a.id === animalId);
                const div = createAnimalElement(animal);
                rightShore.appendChild(div);
            });

            // ë°° ì•ˆì˜ ë™ë¬¼ë“¤
            gameState.boat.forEach(animalId => {
                const animal = animals.find(a => a.id === animalId);
                const div = createAnimalElement(animal, true);
                boatAnimals.appendChild(div);
            });

            // ë°° ì¤‘ëŸ‰ í‘œì‹œ
            const currentWeight = getAnimalWeight(gameState.boat);
            weightDisplay.textContent = `${currentWeight}/${gameState.maxWeight}`;

            if (currentWeight > gameState.maxWeight) {
                weightDisplay.classList.add('overweight');
            } else {
                weightDisplay.classList.remove('overweight');
            }

            // ë°° ìœ„ì¹˜
            const boat = document.getElementById('boat');
            boat.className = gameState.boatPosition === 'left' ? 'boat boat-left' : 'boat boat-right';

            // ì´ë™ íšŸìˆ˜
            document.getElementById('movesCounter').textContent = gameState.moves;
        }

        function createAnimalElement(animal, inBoat = false) {
            const div = document.createElement('div');
            div.className = 'animal';
            div.innerHTML = animal.emoji;
            div.title = `${animal.name} (${animal.weight})`;
            div.dataset.id = animal.id;

            if (!inBoat) {
                const weightSpan = document.createElement('div');
                weightSpan.className = 'weight';
                weightSpan.textContent = animal.weight;
                div.appendChild(weightSpan);
            }

            // ëª¨ë“  ë™ë¬¼ì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ (ê°•ë‘‘ê³¼ ë°° ëª¨ë‘)
            div.onclick = () => selectAnimal(animal.id);

            return div;
        }

        function selectAnimal(animalId) {
            const currentShore = gameState.boatPosition === 'left' ? gameState.leftShore : gameState.rightShore;

            // ë°°ì— ì´ë¯¸ ìˆëŠ” ë™ë¬¼ì¸ì§€ ë¨¼ì € í™•ì¸
            if (gameState.boat.includes(animalId)) {
                // ë°°ì—ì„œ ë‚´ë¦¬ê¸°
                gameState.boat = gameState.boat.filter(id => id !== animalId);
                currentShore.push(animalId);
                updateStatus(`${animals.find(a => a.id === animalId).name}ì„(ë¥¼) ë°°ì—ì„œ ë‚´ë ¸ìŠµë‹ˆë‹¤.`);
            } else {
                // ë™ë¬¼ì´ í˜„ì¬ ê°•ë‘‘ì— ìˆëŠ”ì§€ í™•ì¸
                if (!currentShore.includes(animalId)) {
                    updateStatus('âš ï¸ ë°°ê°€ ìˆëŠ” ìª½ì˜ ë™ë¬¼ë§Œ íƒœìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤!', 'warning');
                    return;
                }

                // ë°°ì— íƒœìš°ê¸°
                gameState.boat.push(animalId);
                const index = currentShore.indexOf(animalId);
                currentShore.splice(index, 1);

                const currentWeight = getAnimalWeight(gameState.boat);
                const animalName = animals.find(a => a.id === animalId).name;

                if (currentWeight > gameState.maxWeight) {
                    updateStatus(`âš ï¸ ${animalName}ì„(ë¥¼) íƒœì› ìŠµë‹ˆë‹¤. ì¤‘ëŸ‰ ì´ˆê³¼! (${currentWeight}/${gameState.maxWeight})`, 'warning');
                } else {
                    updateStatus(`${animalName}ì„(ë¥¼) ë°°ì— íƒœì› ìŠµë‹ˆë‹¤. (${currentWeight}/${gameState.maxWeight})`);
                }
            }

            renderGame();
        }

        function moveBoat() {
            if (gameState.boat.length === 0) {
                updateStatus('âš ï¸ ë°°ì— ìµœì†Œ 1ë§ˆë¦¬ì˜ ë™ë¬¼ì„ íƒœì›Œì•¼ í•©ë‹ˆë‹¤!', 'warning');
                return;
            }

            // ì¤‘ëŸ‰ ì²´í¬
            const currentWeight = getAnimalWeight(gameState.boat);
            if (currentWeight > gameState.maxWeight) {
                updateStatus(`âš ï¸ ì¤‘ëŸ‰ ì´ˆê³¼! í˜„ì¬: ${currentWeight}, ìµœëŒ€: ${gameState.maxWeight}`, 'warning');
                return;
            }

            // ì¶œë°œ ì „ì— ë‚¨ê²¨ì§ˆ ë™ë¬¼ë“¤ ì²´í¬ (ì¡°ë ¨ì‚¬ê°€ ë– ë‚˜ê¸° ì „ì—)
            const departureShore = gameState.boatPosition === 'left' ? gameState.leftShore : gameState.rightShore;
            const remainingAnimals = [...departureShore]; // í˜„ì¬ ê°•ë‘‘ì˜ ëª¨ë“  ë™ë¬¼

            // ë°° ì´ë™ ì• ë‹ˆë©”ì´ì…˜
            gameState.boatPosition = gameState.boatPosition === 'left' ? 'right' : 'left';
            gameState.moves++;

            updateStatus('ğŸš£ ë°°ê°€ ì´ë™ ì¤‘ì…ë‹ˆë‹¤...');

            // ë¨¼ì € ë°°ë§Œ ì´ë™ (ë™ë¬¼ì€ ë°°ì— ê·¸ëŒ€ë¡œ)
            renderGame();

            // ë°°ê°€ ë– ë‚œ í›„ ì¶œë°œì§€ì— ë‚¨ì€ ë™ë¬¼ë“¤ ì²´í¬
            setTimeout(() => {
                // ì¶œë°œì§€ì— ë‚¨ì€ ë™ë¬¼ë“¤ì´ ì‹¸ìš°ëŠ”ì§€ ì²´í¬ (ì¡°ë ¨ì‚¬ê°€ ë– ë‚¬ìœ¼ë¯€ë¡œ)
                if (!isShoreSafe(remainingAnimals)) {
                    handleFight(remainingAnimals, gameState.boatPosition === 'left' ? 'ì˜¤ë¥¸ìª½' : 'ì™¼ìª½');
                    return;
                }
            }, 500);

            // 2ì´ˆ í›„ (ë°° ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„) ë™ë¬¼ë“¤ì„ ê°•ë‘‘ìœ¼ë¡œ ë‚´ë¦¬ê¸°
            setTimeout(() => {
                const targetShore = gameState.boatPosition === 'left' ? gameState.leftShore : gameState.rightShore;
                targetShore.push(...gameState.boat);
                gameState.boat = [];

                renderGame();

                // ë„ì°© í›„ ì¡°ë ¨ì‚¬ê°€ ë‚´ë¦° ê³³ì€ ì•ˆì „ (ì¡°ë ¨ì‚¬ê°€ í•¨ê»˜ ìˆìŒ)
                checkWin();
            }, 2000);
        }

        function isShoreSafe(shoreAnimals) {
            // ê°•ë‘‘ì— ë™ë¬¼ì´ ì—†ê±°ë‚˜ 1ë§ˆë¦¬ë§Œ ìˆìœ¼ë©´ ì•ˆì „
            if (shoreAnimals.length <= 1) return true;

            // ì¡°ë ¨ì‚¬ê°€ ì—†ëŠ” ìƒíƒœì—ì„œ ì‹¸ìš°ëŠ” ì¡°í•© ì²´í¬
            for (let pair of fightPairs) {
                if (shoreAnimals.includes(pair[0]) && shoreAnimals.includes(pair[1])) {
                    return false;
                }
            }

            return true;
        }

        function handleFight(shoreAnimals, shoreName) {
            // ì–´ë–¤ ë™ë¬¼ë“¤ì´ ì‹¸ìš°ëŠ”ì§€ ì°¾ê¸°
            let fightingPair = null;
            for (let pair of fightPairs) {
                if (shoreAnimals.includes(pair[0]) && shoreAnimals.includes(pair[1])) {
                    fightingPair = pair;
                    break;
                }
            }

            if (fightingPair) {
                const animal1 = animals.find(a => a.id === fightingPair[0]);
                const animal2 = animals.find(a => a.id === fightingPair[1]);

                animateFight(fightingPair);
                updateStatus(`ğŸ’¥ ${shoreName} ê°•ë‘‘ì—ì„œ ${animal1.name}ì™€(ê³¼) ${animal2.name}ì´(ê°€) ì‹¸ì› ìŠµë‹ˆë‹¤!`, 'warning');

                setTimeout(() => {
                    showGameOverModal(shoreName, animal1, animal2);
                }, 2000);
            }
        }

        function showGameOverModal(shoreName, animal1, animal2) {
            const modal = document.getElementById('gameOverModal');
            const detail = document.getElementById('gameOverDetail');

            detail.innerHTML = `
                <div style="font-size: 40px; margin-bottom: 15px;">${animal1.emoji} VS ${animal2.emoji}</div>
                <strong>${shoreName} ê°•ë‘‘</strong>ì—ì„œ<br>
                <strong>${animal1.name}</strong>ì™€(ê³¼) <strong>${animal2.name}</strong>ì´(ê°€)<br>
                ì¡°ë ¨ì‚¬ ì—†ì´ ì‹¸ì› ìŠµë‹ˆë‹¤!<br><br>
                <div style="font-size: 14px; color: #999;">ì´ë™ íšŸìˆ˜: ${gameState.moves}íšŒ</div>
            `;

            modal.classList.add('show');
        }

        function closeGameOverModal() {
            const modal = document.getElementById('gameOverModal');
            modal.classList.remove('show');
            resetGame();
        }

        function checkSafety() {
            // ê° ê°•ë‘‘ì—ì„œ ì‹¸ì›€ ì²´í¬
            const shores = [
                { name: 'ì™¼ìª½', animals: gameState.leftShore },
                { name: 'ì˜¤ë¥¸ìª½', animals: gameState.rightShore }
            ];

            for (let shore of shores) {
                if (!isShoreSafe(shore.animals)) {
                    handleFight(shore.animals, shore.name);
                    return false;
                }
            }

            updateStatus('âœ… ì•ˆì „í•©ë‹ˆë‹¤! ë‹¤ìŒ ë™ë¬¼ì„ ì´ë™ì‹œí‚¤ì„¸ìš”.');
            return true;
        }

        function animateFight(fightingPair) {
            fightingPair.forEach(animalId => {
                const elements = document.querySelectorAll(`[data-id="${animalId}"]`);
                elements.forEach(el => {
                    if (!el.closest('.boat-animals')) {
                        el.classList.add('fight-animation');
                    }
                });
            });
        }

        function checkWin() {
            if (gameState.rightShore.length === 5) {
                updateStatus(`ğŸ‰ ê²Œì„ í´ë¦¬ì–´! ${gameState.moves}ë²ˆ ì´ë™`, 'success');
                setTimeout(() => {
                    showWinModal();
                }, 500);
            }
        }

        function showWinModal() {
            const modal = document.getElementById('winModal');
            const detail = document.getElementById('winDetail');
            const minMoves = 7;
            const moveDiff = gameState.moves - minMoves;

            let resultMessage = `ëª¨ë“  ë™ë¬¼ì„ ì•ˆì „í•˜ê²Œ ê±´ë„œìŠµë‹ˆë‹¤!<br><br>`;
            resultMessage += `<strong style="font-size: 24px; color: #667eea;">ì´ë™ íšŸìˆ˜: ${gameState.moves}íšŒ</strong><br><br>`;

            if (gameState.moves === minMoves) {
                resultMessage += `ğŸ† <strong style="color: #f39c12;">ì™„ë²½í•©ë‹ˆë‹¤!</strong><br>ìµœì†Œ ì´ë™ íšŸìˆ˜ë¡œ í´ë¦¬ì–´!`;
            } else if (gameState.moves <= minMoves + 2) {
                resultMessage += `â­ <strong style="color: #27ae60;">í›Œë¥­í•©ë‹ˆë‹¤!</strong><br>(ìµœì†Œ: ${minMoves}íšŒ, +${moveDiff}íšŒ)`;
            } else {
                resultMessage += `âœ… <strong style="color: #3498db;">í´ë¦¬ì–´!</strong><br>(ìµœì†Œ: ${minMoves}íšŒ, +${moveDiff}íšŒ)`;
            }

            detail.innerHTML = resultMessage;
            modal.classList.add('show');
        }

        function closeWinModal() {
            const modal = document.getElementById('winModal');
            modal.classList.remove('show');
            resetGame();
        }

        function updateStatus(message, type = '') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = 'status ' + type;
        }

        function resetGame() {
            gameState = {
                leftShore: ['elephant', 'tiger', 'dog', 'cat', 'mouse'],
                rightShore: [],
                boat: [],
                boatPosition: 'left',
                moves: 0,
                maxWeight: 5000
            };
            renderGame();
            updateStatus('ë™ë¬¼ì„ í´ë¦­í•˜ì—¬ ë°°ì— íƒœìš°ì„¸ìš”!');
        }

        // ê²Œì„ ì‹œì‘
        initGame();
    </script>
</body>
</html>
